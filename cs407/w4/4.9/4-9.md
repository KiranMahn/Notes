# 4.9 Logging basics 

# Overview of Computer Security Log Management

## Introduction
A log is a record of events within an organizationâ€™s systems and networks, containing entries that capture specific events. Initially used for troubleshooting, logs now support various functions like system optimization, user activity tracking, and security investigations.

## Importance of Security Logs
Modern logs have evolved to include data relevant to security, such as:
- **Audit Logs**: Track user authentication attempts.
- **Security Device Logs**: Record potential attacks.

With the rise of networked systems and growing threats, the volume and complexity of security logs have increased, necessitating effective log management.

## Key Components
1. **Basics**: Understanding computer security logs.
2. **Legal and Operational Needs**: Compliance with laws and organizational requirements.
3. **Challenges**: Managing the scale and diversity of logs.
4. **Recommendations**: High-level strategies for effective log management.

This guide addresses generating, storing, analyzing, and disposing of security log data to enhance organizational security.

# Basics of Computer Security Logs

## Overview
Logs capture a wide array of events within systems and networks, offering insights for troubleshooting, performance optimization, and security. Various logs hold security-related information, with some being essential for continuous monitoring and incident response.

## Categories of Security Logs
1. **Security Software Logs**: Generated by tools like antivirus, intrusion detection systems, VPNs, and firewalls. These logs track malware detection, access attempts, and network activity.
2. **Operating System and Application Logs**: Offer supplementary data on security-related events.
3. **Additional Sources**: Network devices and monitoring software may provide relevant security information when needed.

Organizations should assess and incorporate valuable sources when designing a log management strategy.

## Security Software Examples
- **Antimalware**: Records detections, scans, and updates.
- **Intrusion Detection Systems (IDS)**: Logs suspicious behaviors and attacks.
- **VPNs**: Track login attempts and session data.
- **Firewalls**: Monitor network traffic, blocking unauthorized access.
- **Routers and Quarantine Servers**: Log policy-based actions and host compliance.

The selection and proper management of logs play a critical role in securing systems and networks, aiding in incident response, compliance, and threat detection.

## Operating Systems Security Logs

### Overview
Operating systems (OS) for devices such as servers, workstations, and networking equipment log various security-related events. These logs help in identifying and investigating suspicious activities.

### Common Types of OS Log Data
- **System Events**: Actions by OS components (e.g., system shutdowns, service starts). Includes timestamps, event codes, and associated user accounts.
- **Audit Records**: Records security events (e.g., authentication attempts, file access, security policy changes). Administrators can configure which events are logged.

### Usage
OS logs are crucial for investigating suspicious host activities, often supplementing data from security software. They may be stored in syslog format or proprietary formats (e.g., Windows logs).

## Application Security Logs

### Overview
Applications, including COTS, GOTS, and custom-developed ones, often log data to help organizations monitor security and compliance. These logs can contain a range of information types.

### Commonly Logged Data
- **Client Requests/Server Responses**: Helps trace events and identify user actions. 
- **Account Information**: Logs on authentication attempts, account changes, and privileges.
- **Usage Information**: Tracks transaction counts and sizes, useful for security monitoring.
- **Operational Actions**: Logs events like app startups, shutdowns, and configuration changes.

## Usefulness of Logs

Logs from different systems (network devices, OS, applications) provide various levels of detail useful for specific scenarios, such as detecting attacks, fraud, or misuse. Typically:
- **Primary Logs**: Offer detailed, direct information (e.g., intrusion detection logs).
- **Secondary Logs**: Provide supplementary context (e.g., firewall logs).
- **Log Security**: Securing log sources is crucial to ensure reliability; compromised systems' logs should be cross-verified.

Understanding which logs serve as primary or secondary sources aids in effective incident handling and investigation.

# 2.2 The Need for Log Management

Log management benefits organizations in various ways, ensuring that security records are stored in sufficient detail for appropriate durations. Key advantages include:

- **Incident Identification**: Routine log reviews help identify security incidents, policy violations, fraudulent activities, and operational problems soon after they occur.
- **Problem Resolution**: Logs provide information useful for resolving issues.
- **Auditing and Forensics**: Logs are essential for auditing, forensic analysis, and supporting internal investigations.
- **Baseline Establishment**: They aid in establishing baselines and identifying operational trends and long-term problems.

## Regulatory Compliance

Organizations are compelled by several laws and regulations to store and review logs, including:

- **Federal Information Security Management Act of 2002 (FISMA)**: Requires Federal agencies to implement a security program for their information systems, with NIST SP 800-53 outlining recommended security controls related to log management.
  
- **Gramm-Leach-Bliley Act (GLBA)**: Mandates financial institutions to protect customer information, with log management helping to identify and resolve security violations.

- **Health Insurance Portability and Accountability Act of 1996 (HIPAA)**: Specifies security standards for health information, with NIST SP 800-66 detailing HIPAA-related log management needs, including regular reviews and documentation retention for at least six years.

- **Sarbanes-Oxley Act (SOX) of 2002**: Primarily focuses on financial practices but also includes IT functions. Regular log reviews are necessary to look for security violations and retain logs for future audits.

- **Payment Card Industry Data Security Standard (PCI DSS)**: Applies to organizations that handle cardholder data, requiring them to track access to network resources and cardholder data.

# 2.3 The Challenges in Log Management

Organizations commonly face challenges in log management, stemming from balancing limited resources against increasing log data. The challenges can be grouped into three categories:

1. **Log Generation Issues**: Problems arise from the variety and prevalence of generated logs.
2. **Log Security**: There are risks to the confidentiality, integrity, and availability of logs, which can be breached inadvertently or intentionally.
3. **Inadequate Support for Analysis**: Personnel responsible for log analysis are often not adequately prepared or supported.

Further details on each of these challenges can be found in sections 2.3.1 to 2.3.3.

